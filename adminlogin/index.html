<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login Admin</title>
<script type="module" src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm"></script>
<style>
  body { font-family: sans-serif; display:flex; justify-content:center; align-items:center; height:100vh; background:#f0f2f5; }
  .login-box { background:#fff; padding:40px; border-radius:10px; box-shadow:0 4px 10px rgba(0,0,0,0.1); width:300px; }
  input, button { width:100%; padding:10px; margin:10px 0; border-radius:5px; border:1px solid #ccc; }
  button { background:#007bff; color:white; border:none; cursor:pointer; }
  button:hover { background:#0056b3; }
</style>
</head>
<body>
<div class="login-box">
  <h2>Login Admin</h2>
  <input type="email" id="email" placeholder="Email" />
  <input type="password" id="password" placeholder="Password" />
  <button id="loginBtn">Login</button>
  <p id="msg" style="color:red;"></p>
</div>

<script type="module">
  import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';
  const SUPABASE_URL = "https://jpxtbdawajjyrvqrgijd.supabase.co";
  const SUPABASE_ANON_KEY = "YOUR_SUPABASE_ANON_KEY";
  const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  const loginBtn = document.getElementById('loginBtn');
  const msg = document.getElementById('msg');

  loginBtn.addEventListener('click', async () => {
    const email = document.getElementById('email').value;
    const password = document.getElementById('password').value;

    const { data, error } = await supabase.auth.signInWithPassword({ email, password });

    if (error) {
      msg.textContent = error.message;
      return;
    }

    // cek role admin
    const { data: profile } = await supabase
      .from('profiles')
      .select('role')
      .eq('id', data.user.id)
      .single();

    if (profile.role !== 'admin' && profile.role !== 'superadmin') {
      msg.textContent = "Anda tidak memiliki akses ke dashboard.";
      await supabase.auth.signOut();
      return;
    }

    // login berhasil â†’ arahkan ke dashboard
    window.location.href = '/teras/ruang/';
  });
</script>
</body>
</html>
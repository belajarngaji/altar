<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eksperimen Service Role Key</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body class="bg-gray-900 text-white p-8">
    <div class="max-w-2xl mx-auto">
        <h1 class="text-2xl font-bold text-red-400">⚠️ Halaman Eksperimen Berbahaya ⚠️</h1>
        <p class="mt-2 text-gray-400">Halaman ini menggunakan Service Role Key di front-end. Ini HANYA untuk tujuan pembelajaran dan tidak boleh digunakan di aplikasi sungguhan.</p>
        
        <button id="fetch-button" class="mt-6 bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded">
            Jalankan Query Super Admin (Abaikan RLS)
        </button>

        <h2 class="mt-8 text-xl font-bold border-b border-gray-700 pb-2">Hasil Query:</h2>
        <pre id="results" class="mt-4 bg-gray-800 p-4 rounded-lg text-sm whitespace-pre-wrap">Klik tombol untuk melihat hasil...</pre>
    </div>

    <script type="module">
        const { createClient } = supabase;

        const SUPABASE_URL = "https://jpxtbdawajjyrvqrgijd.supabase.co"; 
        
        // --- PERINGATAN KERAS: INI SANGAT BERBAHAYA DI FRONT-END ---
        // Kunci ini memberikan akses penuh ke database Anda.
        const SUPABASE_SERVICE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpweHRiZGF3YWpqeXJ2cXJnaWpkIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1NjMxMjg5OCwiZXhwIjoyMDcxODg4ODk4fQ.1-CFqhW0mXPyv8jFyd-sa4m2FoCkyY4LbgiKGIKwb6I"; // Ganti dengan Service Role Key Anda
        // -----------------------------------------------------------

        // Kita membuat klien Supabase baru menggunakan kunci super admin
        const supabaseAdmin = createClient(SUPABASE_URL, SUPABASE_SERVICE_KEY);

        const fetchButton = document.getElementById('fetch-button');
        const resultsPre = document.getElementById('results');

        fetchButton.addEventListener('click', async () => {
            resultsPre.textContent = 'Memuat data...';
            
            // Fungsi ini akan mengambil SEMUA data dari tabel 'profiles',
            // mengabaikan semua aturan RLS yang kita buat.
            const { data, error } = await supabaseAdmin
                .from('profiles')
                .select('*');

            if (error) {
                resultsPre.textContent = `Error: ${error.message}`;
                resultsPre.classList.add('text-red-400');
            } else {
                // Tampilkan data mentah dalam format JSON
                resultsPre.textContent = JSON.stringify(data, null, 2);
                resultsPre.classList.remove('text-red-400');
            }
        });
    </script>
</body>
</html>
